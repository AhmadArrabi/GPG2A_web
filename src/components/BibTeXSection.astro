---
import Section from "./Section.astro";
import { Icon } from "astro-icon/components";

interface Props {
  data: string;
}

const { data } = Astro.props;
---

<Section>
  <h2 class="w-full text-3xl font-bold flex flex-row items-center gap-2">
    <span>BibTeX</span>
    <Icon
      class="cursor-pointer hover:text-zinc-500 active:text-zinc-700"
      id="copy-bibtex"
      name="lucide:clipboard-copy"
    />
    <Icon
      class="hidden"
      id="copy-bibtex-successful"
      name="lucide:clipboard-check"
    />
  </h2>
  <code class="whitespace-pre overflow-auto bg-zinc-300 p-4 rounded-lg w-full">
    {data}
  </code>
</Section>
<script define:vars={{ data }}>
  function copyBibtex() {
    const copyButton = document.querySelector("#copy-bibtex");
    const successIcon = document.querySelector("#copy-bibtex-successful");
    if (copyButton && successIcon) {
      navigator.clipboard.writeText(data).catch((err) => {
        console.error("Failed to copy BibTeX data: ", err);
      });
      copyButton.style.display = "none";
      successIcon.style.display = "inline";
      setTimeout(() => {
        copyButton.style.display = "inline";
        successIcon.style.display = "none";
      }, 1000);
    }
  }
  const copyButton = document.querySelector("#copy-bibtex");
  if (copyButton) {
    copyButton.addEventListener("click", () => copyBibtex());
  }
</script>
